//  11) Create a stored procedure that will take ZoneName as an input and display list of patient who are not discharged 
// yet.
//  SpNotDischargedbyZoneName(‘ATHWA’);

create or replace procedure SpNotDischargedbyZoneName(zname zone.zonename%type)
as 
begin
    for rec in (
        select p.patientid, p.patientname, c.categoryname, w.wardname, z.zonename, p.admitteddate 
        from patient p, patientcategory c, ward w, zone z
        where p.categoryid=c.categoryid and p.wardid=w.wardid and w.zoneid=z.zoneid and z.zonename=zname
    )
    loop
        dbms_output.put_line('PatientID: '   || rec.patientid ||
                             ', Name: '      || rec.patientname ||
                             ', CategoryName: ' || rec.categoryname ||
                             ', Ward: '      || rec.wardname ||
                             ', Zone: '      || rec.zonename ||
                             ', Admitted: '  || TO_CHAR(rec.admitteddate,'DD-MON-YYYY'));
    end loop;
end;


begin
SpNotDischargedbyZoneName('ATHWA'); 
end;


//  12) Create a stored procedure that will take ZoneName and Admitted Date as an input and display list of patient who
//  are not discharged yet.
//  SpNotDischargedbyZNandDate(‘ATHWA’, 01-06-2024);

create or replace procedure spnotdischargedbyznanddate(
    p_zonename in varchar2,
    p_admitteddate in date
)
as
begin
    for rec in (
        select 
            p.patientid,
            p.patientname,
            p.categoryid,
            p.wardid,
            p.admitteddate,
            p.dischargedate,
            z.zonename
        from 
            patient p
        join 
            ward w on p.wardid = w.wardid
        join 
            zone z on w.zoneid = z.zoneid
        where 
            z.zonename = p_zonename
            and trunc(p.admitteddate) = trunc(p_admitteddate)
            and p.dischargedate is null
    )
    loop
        dbms_output.put_line(
            'id: ' || rec.patientid || 
            ', name: ' || rec.patientname || 
            ', ward: ' || rec.wardid || 
            ', admitted: ' || to_char(rec.admitteddate, 'dd-mm-yyyy')
        );
    end loop;
end;

begin
  SpNotDischargedbyZNandDate('ATHWA', '02-AUG-25');
end;

//  13) Create a stored procedure that will take WardName as an input and display list of patient whe are not discharged 
// yet.
//  SpNotDischargedbyWardName(‘GHOD DOD’)

create or replace procedure spnotdischargedbywardname(
    p_wardname in varchar2
)
as
begin
    for rec in (
        select 
            p.patientid,
            p.patientname,
            p.categoryid,
            p.wardid,
            p.admitteddate,
            p.dischargedate,
            w.wardname
        from 
            patient p
        join 
            ward w on p.wardid = w.wardid
        where 
            w.wardname = p_wardname
            and p.dischargedate is null
    )
    loop
        dbms_output.put_line(
            'id: ' || rec.patientid || 
            ', name: ' || rec.patientname || 
            ', ward: ' || rec.wardid || 
            ', admitted: ' || to_char(rec.admitteddate, 'dd-mm-yyyy')
        );
    end loop;
end;

begin
  spnotdischargedbywardname('BHATAR');
end;


4:


create table booksubject (
    booksub_id number primary key,
    booksubject_name varchar2(50)
);

create table author (
    author_id number primary key,
    author_name varchar2(50)
);

create table book (
    book_id number primary key,
    book_name varchar2(50),
    book_price number(10,2),
    book_qty number,
    discount_amt number(10,2),
    netprice number(10,2),
    booksub_id number,
    author_id number,
    purchasedate date,
    foreign key (booksub_id) references booksubject(booksub_id),
    foreign key (author_id) references author(author_id)
);


insert all
    into booksubject(booksub_id, booksubject_name) values(1,'science')
    into booksubject(booksub_id, booksubject_name) values(2,'literature')
    into booksubject(booksub_id, booksubject_name) values(3,'history')
select * from dual;


insert all
    into author(author_id, author_name) values(1,'jk rowling')
    into author(author_id, author_name) values(2,'isaac asimov')
    into author(author_id, author_name) values(3,'stephen king')
select * from dual;


insert all
    into book(book_id, book_name, book_price, book_qty, discount_amt, netprice, booksub_id, author_id, purchasedate) 
        values(1,'harry potter',500,10,50,450,2,1,to_date('10-jan-2020','dd-mm-yyyy'))
    into book(book_id, book_name, book_price, book_qty, discount_amt, netprice, booksub_id, author_id, purchasedate) 
        values(2,'foundation',600,5,60,540,1,2,to_date('05-feb-2020','dd-mm-yyyy'))
    into book(book_id, book_name, book_price, book_qty, discount_amt, netprice, booksub_id, author_id, purchasedate) 
        values(3,'it',700,3,70,630,2,3,to_date('15-mar-2020','dd-mm-yyyy'))
    into book(book_id, book_name, book_price, book_qty, discount_amt, netprice, booksub_id, author_id, purchasedate) 
        values(4,'science basics',400,8,40,360,1,2,to_date('20-aug-2020','dd-mm-yyyy'))
    into book(book_id, book_name, book_price, book_qty, discount_amt, netprice, booksub_id, author_id, purchasedate) 
        values(5,'literature guide',450,6,45,405,2,1,to_date('01-oct-2020','dd-mm-yyyy'))
select * from dual;


1.
create or replace procedure sp_most_expensive_book
as
begin
    for rec in (
        select *
        from book
        where netprice = (select max(netprice) from book)
    )
    loop
        dbms_output.put_line(
            'id: ' || rec.book_id || 
            ', name: ' || rec.book_name || 
            ', price: ' || rec.book_price || 
            ', netprice: ' || rec.netprice
        );
    end loop;
end;


begin
sp_most_expensive_book;
end;



2.
create or replace procedure sp_count_books_by_subject(
    p_booksub_name in varchar2
)
as
    v_count number;
begin
    select count(*)
    into v_count
    from book b
    join booksubject bs on b.booksub_id = bs.booksub_id
    where bs.booksubject_name = p_booksub_name;

    dbms_output.put_line('total books for subject "' || p_booksub_name || '" = ' || v_count);
end;


begin
sp_count_books_by_subject('literature');
end;

3.
create or replace procedure sp_books_by_author(
    p_author_name in varchar2
)
as
begin
    for rec in (
        select b.book_id, b.book_name, b.netprice
        from book b
        join author a on b.author_id = a.author_id
        where a.author_name = p_author_name
    )
    loop
        dbms_output.put_line(
            'id: ' || rec.book_id || 
            ', name: ' || rec.book_name || 
            ', netprice: ' || rec.netprice
        );
    end loop;
end;

begin
sp_books_by_author('jk rowling');
end;


4.
create or replace procedure sp_total_amount_by_duration(
    p_start_date in date,
    p_end_date in date
)
as
    v_total number;
begin
    select sum(netprice)
    into v_total
    from book
    where purchasedate between p_start_date and p_end_date;

    dbms_output.put_line(
        'total amount of books purchased between ' || 
        to_char(p_start_date,'dd-mm-yyyy') || ' and ' || 
        to_char(p_end_date,'dd-mm-yyyy') || ' = ' || v_total
    );
end;



begin
    sp_total_amount_by_duration(
        to_date('01-01-2020','dd-mm-yyyy'),
        to_date('15-10-2020','dd-mm-yyyy')
    );
end;



Kotlin:

MainActivity.kt:

package com.example.asiignment2

import android.os.Bundle
import android.widget.Button
import android.widget.EditText
import android.widget.TextView
import androidx.activity.enableEdgeToEdge
import androidx.appcompat.app.AppCompatActivity
import androidx.core.view.ViewCompat
import androidx.core.view.WindowInsetsCompat

data class student(
    var rollNo: Int,
    var name: String,
    var marks1: Int,
    var marks2: Int,
    var marks3: Int
) {
    var total: Int = 0
    var percentage: Double = 0.0
    var grade: String = ""

    fun calculate() {
        total = marks1 + marks2 + marks3
        percentage = total / 3.0

        grade = when {
            percentage >= 90 -> "A+"
            percentage >= 80 -> "A"
            percentage >= 70 -> "B"
            percentage >= 60 -> "C"
            percentage >= 50 -> "D"
            else -> "F"
        }
    }
}
class MainActivity : AppCompatActivity() {
    private val students = mutableListOf<student>()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(R.layout.activity_main)
        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main)) { v, insets ->
            val systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars())
            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom)
            insets
        }

        val etRollNo: EditText = findViewById(R.id.etRollNo)
        val etName: EditText = findViewById(R.id.etName)
        val etMarks1: EditText = findViewById(R.id.etMarks1)
        val etMarks2: EditText = findViewById(R.id.etMarks2)
        val etMarks3: EditText = findViewById(R.id.etMarks3)
        val btnAddStudent:Button = findViewById(R.id.btnAddStudent)
        val btnShowStudent:Button = findViewById(R.id.btnShowStudent)
        val btnShowTopStudent:Button = findViewById(R.id.btnShowTopStudent)
        val tvOutput:TextView = findViewById(R.id.tvOutput)

        btnAddStudent.setOnClickListener {
            val rollNo = etRollNo.text.toString().toIntOrNull() ?: 0
            val name = etName.text.toString()
            val marks1 = etMarks1.text.toString().toIntOrNull() ?: 0
            val marks2 = etMarks2.text.toString().toIntOrNull() ?: 0
            val marks3 = etMarks3.text.toString().toIntOrNull() ?: 0

            val student = student(rollNo, name, marks1, marks2, marks3)
            student.calculate()
            students.add(student)

            tvOutput.text = "Added..."

            etRollNo.text.clear()
            etName.text.clear()
            etMarks1.text.clear()
            etMarks2.text.clear()
            etMarks3.text.clear()
        }

        btnShowTopStudent.setOnClickListener {
            val topStudent = students.maxByOrNull { it.total }
            if (topStudent != null) {
                tvOutput.text = "Top Student:\nRoll No: ${topStudent.rollNo}, Name: ${topStudent.name}, Total: ${topStudent.total}, Percentage: ${"%.2f".format(topStudent.percentage)}, Grade: ${topStudent.grade}"
            } else {
                tvOutput.text = "No student data available"
            }
        }

        btnShowStudent.setOnClickListener {
            if (students.isEmpty()) {
                tvOutput.text = "No student data available"
            } else {
                var data = ""
                for (s in students) {
                    data += "Roll No: ${s.rollNo}, Name: ${s.name}, Marks: ${s.marks1}, ${s.marks2}, ${s.marks3}, " +
                            "Total: ${s.total}, Percentage: ${"%.2f".format(s.percentage)}, Grade: ${s.grade}\n"
                }
                tvOutput.text = data
            }
        }
    }
}



xml:
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity"
    android:layout_margin="30dp"
    android:orientation="vertical">

<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <LinearLayout
        android:id="@+id/container"
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:padding="16dp">

        <EditText
            android:id="@+id/etRollNo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="Roll Number"
            android:inputType="number"/>

        <EditText
            android:id="@+id/etName"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="Name"
            android:inputType="textPersonName"/>

        <EditText
            android:id="@+id/etMarks1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="Marks Subject 1"
            android:inputType="number"/>

        <EditText
            android:id="@+id/etMarks2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="Marks Subject 2"
            android:inputType="number"/>

        <EditText
            android:id="@+id/etMarks3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:hint="Marks Subject 3"
            android:inputType="number"/>

        <Button
            android:id="@+id/btnAddStudent"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Add Student"/>

        <Button
            android:id="@+id/btnShowStudent"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Show All Student"
            android:layout_marginTop="8dp"/>

        <Button
            android:id="@+id/btnShowTopStudent"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Show 1st Rank Student"
            android:layout_marginTop="8dp"/>

        <TextView
            android:id="@+id/tvOutput"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text=""
            android:paddingTop="16dp"/>

    </LinearLayout>

</ScrollView>

</LinearLayout>